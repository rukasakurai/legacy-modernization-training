# テスト駆動開発（TDD = Test-Driven Development）

このラボでは、テスト駆動開発（TDD = Test-Driven Development）のRed→Green→→Blueの流れを体験します。キャラクタリゼーションテストで固定した振る舞いを守りつつ、モダンな実装へのリファクタリングや同等性検証、回帰検出までを含みます。

---

## 学習目標
- TDDのRed→Green→Refactorサイクルを体験できる
- テスト先行で新実装を開発できる
- 旧実装と新実装の同等性をテストで検証できる
- 回帰（意図しない変更）をテスト失敗から特定・分析できる

---

## 事前準備
1. **Windows + VS Code** を使用（本トレーニング標準環境）
2. **GitHub Copilot Agent Mode** を有効化
3. **JDK 21** がインストール済みであること
4. （任意）Maven プロジェクトとして進めたい場合は `mvn -v` で動作確認
5. VS Code で本ファイルを開き、ラボ手順に従う

---

## ラボ1 — TDD Red フェーズ：新実装のテスト先行
### 目的
TDD の Red を明示的に体験し、「テストが存在しないコードを書かない」姿勢を強化する。
### 作業
まだ存在しない `ModernSumCalculator` を使うテストを先に書く（コンパイルエラー = Red）

## ラボ2 — TDD Green フェーズ：最小実装でテストを通す
### 目的
TDD の Green フェーズでは、テストが失敗している状態（Red）から、最小限の実装を追加してテストを成功（Green）させることを体験します。余計な実装を加えず、テストを通すために必要な最小限のコードを書くことの重要性を学びます。

### 作業
最小実装でテストを通す（Green）

### Copilot プロンプト例
```
存在しない ModernSumCalculator に対するテストを書いたので、テストが通る最小のクラス骨格を生成してください。
```

---

## ラボ3 — TDD Blue フェーズ：リファクタリング（Refactor）：モダン実装への書き換え
### 目的
TDD の Refactor として内部実装を Stream API へ置き換えつつ、振る舞いを維持する。
### 作業
`ModernSumCalculator` の本実装を Stream API に差し替え。

### Copilot プロンプト例
```
#file:src/test/java/legacy/ModernSumCalculatorTest.java が成功する実装を #file:src/main/java/legacy/ModernSumCalculator.java にしてください。Java 21の機能をフル活用したモダンな実装にしてください。
```

---

## ラボ4 — 回帰検出体験
### 目的
テストが“守っている”ことを実感する。
### 作業
1. `ModernSumCalculator` を意図的に壊す（例：最後の要素を加算しない）
2. テスト失敗を確認し、どのケースが検出したか分析
3. GitHub Copilotに失敗原因を説明させる

---

## Optional ラボ — 旧実装と新実装を並行実行して比較

「レガシー」実装に継続的に変更が加わっており、「レガシー」実装の実行コストやリスクが低い場合には、旧実装と新実装を並行実行して比較する手段が取れる可能性もあります。

### 作業
1. 並行比較用テスト `SumEquivalenceTest` を作成
2. 複数配列（固定 + ランダム）で両者の出力一致をアサート

### GitHub Copilot プロンプト例
```
旧実装と新実装を比較し、結果が一致することを検証するJUnitテストを書いてください。
```

---

## インストラクター向けノート
> **所要時間目安**
> - 60分（参加者のJava経験により変動）

